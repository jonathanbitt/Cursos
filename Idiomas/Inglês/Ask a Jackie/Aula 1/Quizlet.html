<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Flashcards com Revis√£o Cont√≠nua</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border: #dee2e6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --success: #28a745;
            --error: #dc3545;
            --warning: #ffc107;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e6f0ff 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary);
        }
        
        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn i {
            font-size: 1.2rem;
        }
        
        .btn-primary {
            background-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--secondary);
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: var(--dark);
        }
        
        .btn-warning:hover {
            background-color: #e0a800;
        }
        
        .btn-secondary {
            background-color: var(--gray);
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s ease;
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .card-header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .card-footer {
            padding: 15px 20px;
            background: var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-question {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
            min-height: 60px;
        }
        
        .card-answer {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            font-weight: 500;
            color: var(--secondary);
            border-left: 4px solid var(--accent);
        }
        
        .show-answer-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .show-answer-btn:hover {
            background: #3aa8d0;
        }
        
        .counter {
            display: flex;
            gap: 15px;
        }
        
        .counter-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .counter-value {
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
        }
        
        .collection-form {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin: 30px auto;
            max-width: 800px;
            display: none;
        }
        
        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-gray);
        }
        
        h2 {
            color: var(--primary);
            font-size: 1.8rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: monospace;
        }
        
        .form-hint {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: var(--shadow);
            z-index: 1000;
            display: none;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s;
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--error);
        }
        
        .notification.warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }
        
        .empty-state i {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .empty-state p {
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto 25px;
            line-height: 1.6;
        }
        
        .collection-selector {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }
        
        .collection-selector select {
            max-width: 300px;
        }
        
        .audio-player {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .audio-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .audio-btn:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }
        
        .audio-btn i {
            font-size: 1.2rem;
        }
        
        .explanation {
            background-color: #f9f9f9;
            border-left: 4px solid var(--accent);
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9em;
            display: none;
            border-radius: 0 8px 8px 0;
        }
        
        .progress-container {
            width: 100%;
            background: var(--light-gray);
            border-radius: 5px;
            margin: 5px 0;
        }
        
        .progress-bar {
            height: 10px;
            background: var(--success);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .feedback-btn {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .feedback-btn.correct {
            background: var(--success);
            color: white;
        }
        
        .feedback-btn.incorrect {
            background: var(--error);
            color: white;
        }
        
        .feedback-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .collection-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .collection-badge {
            background: var(--accent);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }
        
        .results-container {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin: 30px auto;
            max-width: 800px;
            text-align: center;
            display: none;
        }
        
        .results-header {
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .stats-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
        }
        
        .stat-box {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
            min-width: 150px;
            box-shadow: var(--shadow);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 1.1rem;
            color: var(--gray);
        }
        
        .correct-stat .stat-value {
            color: var(--success);
        }
        
        .incorrect-stat .stat-value {
            color: var(--error);
        }
        
        .review-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .completion-message {
            background: var(--success);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            display: none;
        }
        
        .finish-btn {
            margin-top: 30px;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .review-info {
            background-color: #fff8e1;
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-layer-group"></i> Sistema de Flashcards</h1>
            <div class="header-actions">
                <button id="createCollectionBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Criar Cole√ß√£o
                </button>
                <button id="editCollectionBtn" class="btn btn-warning">
                    <i class="fas fa-edit"></i> Editar Cole√ß√£o
                </button>
            </div>
        </header>
        
        <div class="collection-selector">
            <div class="collection-info">
                <label for="collectionSelect">Cole√ß√£o selecionada:</label>
                <select id="collectionSelect" class="form-control">
                    <option value="numbers">N√∫meros em Ingl√™s</option>
                    <option value="animals">Animais</option>
                    <option value="phrases">Frases Comuns</option>
                </select>
                <span class="collection-badge" id="cardsCount">10 flashcards</span>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="exportCollection()">
                    <i class="fas fa-download"></i> Exportar
                </button>
                <button class="btn btn-secondary" onclick="printCollection()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>
        </div>
        
        <div id="reviewInfo" class="review-info" style="display: none;">
            <h3><i class="fas fa-redo-alt"></i> Modo Revis√£o</h3>
            <p>Voc√™ est√° revisando as quest√µes que errou na rodada anterior.</p>
            <p>Continue at√© acertar todas as quest√µes!</p>
        </div>
        
        <div class="card-container" id="cardsContainer">
            <!-- Cards ser√£o gerados dinamicamente aqui -->
        </div>
        
        <div class="finish-btn">
            <button id="completeBtn" class="btn btn-success" style="padding: 15px 40px; font-size: 1.2rem;">
                <i class="fas fa-check-circle"></i> Concluir Rodada
            </button>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <h2 class="results-header">Resultados da Rodada</h2>
            
            <div class="stats-container">
                <div class="stat-box correct-stat">
                    <div class="stat-value" id="correctCount">0</div>
                    <div class="stat-label">Acertos</div>
                </div>
                
                <div class="stat-box incorrect-stat">
                    <div class="stat-value" id="incorrectCount">0</div>
                    <div class="stat-label">Erros</div>
                </div>
            </div>
            
            <div class="review-section" id="reviewSection">
                <h3>Revisar Quest√µes com Erros</h3>
                <p>As quest√µes que voc√™ errou ser√£o mantidas para revis√£o.</p>
                <p>As quest√µes acertadas foram ocultadas.</p>
                
                <button id="startReviewBtn" class="btn btn-warning" style="margin-top: 20px;">
                    <i class="fas fa-redo"></i> Continuar Revis√£o
                </button>
            </div>
            
            <div class="completion-message" id="completionMessage">
                <h3><i class="fas fa-trophy"></i> Parab√©ns! Voc√™ acertou todas as quest√µes!</h3>
                <p>Voc√™ completou esta cole√ß√£o com sucesso.</p>
                <button id="restartCollectionBtn" class="btn btn-primary" style="margin-top: 15px;">
                    <i class="fas fa-sync-alt"></i> Reiniciar Cole√ß√£o
                </button>
            </div>
        </div>
        
        <div class="collection-form" id="collectionForm">
            <div class="form-header">
                <h2 id="formTitle"><i class="fas fa-folder-plus"></i> Criar Nova Cole√ß√£o</h2>
                <button id="closeFormBtn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            
            <input type="hidden" id="editingCollectionId">
            
            <div class="form-group">
                <label for="collectionName">Nome da Cole√ß√£o</label>
                <input type="text" id="collectionName" placeholder="Ex: N√∫meros em Ingl√™s">
            </div>
            
            <div class="form-group">
                <label for="collectionDescription">Descri√ß√£o</label>
                <input type="text" id="collectionDescription" placeholder="Ex: Flashcards para aprender n√∫meros em ingl√™s">
            </div>
            
            <div class="form-group">
                <label for="flashcardsData">Flashcards (um por linha)</label>
                <textarea id="flashcardsData" placeholder="Formato: Pergunta ; Resposta&#10;Ex: 1 ; one&#10;2 ; two&#10;O cachorro late ; The dog barks"></textarea>
                <p class="form-hint">Digite cada flashcard em uma nova linha, separando pergunta e resposta com ";"</p>
            </div>
            
            <div class="form-actions">
                <button id="cancelFormBtn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button id="saveCollectionBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Salvar Cole√ß√£o
                </button>
            </div>
        </div>
        
        <div class="notification" id="notification"></div>
    </div>

    <script>
        // Dados iniciais dos flashcards
        const sampleFlashcards = {
            numbers: {
                name: "N√∫meros em Ingl√™s",
                description: "Aprenda os n√∫meros de 1 a 10 em ingl√™s",
                cards: [
                    { id: 1, question: "1", answer: "one", answered: 0, correct: 0, explanation: "O n√∫mero 1 em ingl√™s √© 'one'. √â o menor n√∫mero natural." },
                    { id: 2, question: "2", answer: "two", answered: 0, correct: 0, explanation: "'Two' √© o n√∫mero 2 em ingl√™s. Representa um par ou dupla." },
                    { id: 3, question: "3", answer: "three", answered: 0, correct: 0, explanation: "O n√∫mero 3 √© 'three' em ingl√™s. √â considerado um n√∫mero da sorte em muitas culturas." },
                    { id: 4, question: "4", answer: "four", answered: 0, correct: 0, explanation: "'Four' representa o n√∫mero 4. √â o primeiro n√∫mero composto." },
                    { id: 5, question: "5", answer: "five", answered: 0, correct: 0, explanation: "O n√∫mero 5 √© 'five' em ingl√™s. √â a base do sistema decimal." },
                    { id: 6, question: "6", answer: "six", answered: 0, correct: 0, explanation: "'Six' √© o n√∫mero 6. √â o primeiro n√∫mero perfeito na matem√°tica." },
                    { id: 7, question: "7", answer: "seven", answered: 0, correct: 0, explanation: "O n√∫mero 7 √© 'seven' em ingl√™s. Frequentemente associado √† sorte." },
                    { id: 8, question: "8", answer: "eight", answered: 0, correct: 0, explanation: "'Eight' representa o n√∫mero 8. Simboliza infinito quando deitado." },
                    { id: 9, question: "9", answer: "nine", answered: 0, correct: 0, explanation: "O n√∫mero 9 √© 'nine' em ingl√™s. √â o quadrado de 3." },
                    { id: 10, question: "10", answer: "ten", answered: 0, correct: 0, explanation: "'Ten' √© o n√∫mero 10. Forma a base do sistema decimal." }
                ]
            },
            animals: {
                name: "Animais",
                description: "Nomes de animais em ingl√™s",
                cards: [
                    { id: 1, question: "Cachorro", answer: "dog", answered: 0, correct: 0, explanation: "Dog √© a palavra em ingl√™s para cachorro. O som que faz √© 'bark'." },
                    { id: 2, question: "Gato", answer: "cat", answered: 0, correct: 0, explanation: "Cat √© como se diz gato em ingl√™s. O som que faz √© 'meow'." },
                    { id: 3, question: "P√°ssaro", answer: "bird", answered: 0, correct: 0, explanation: "Bird √© a tradu√ß√£o de p√°ssaro. O som caracter√≠stico √© 'tweet'." },
                    { id: 4, question: "Peixe", answer: "fish", answered: 0, correct: 0, explanation: "Fish √© peixe em ingl√™s. Vivem na √°gua e respiram por guelras." },
                    { id: 5, question: "Elefante", answer: "elephant", answered: 0, correct: 0, explanation: "Elephant √© elefante. S√£o os maiores animais terrestres." }
                ]
            },
            phrases: {
                name: "Frases Comuns",
                description: "Frases √∫teis em ingl√™s para conversa√ß√£o",
                cards: [
                    { id: 1, question: "Bom dia", answer: "Good morning", answered: 0, correct: 0, explanation: "'Good morning' √© a sauda√ß√£o matinal em ingl√™s. Usada at√© o meio-dia." },
                    { id: 2, question: "Como voc√™ est√°?", answer: "How are you?", answered: 0, correct: 0, explanation: "Forma comum de cumprimento em ingl√™s. A resposta t√≠pica √© 'I'm fine, thank you'." },
                    { id: 3, question: "Onde fica o banheiro?", answer: "Where is the bathroom?", answered: 0, correct: 0, explanation: "Frase essencial para viagens. Em ingl√™s brit√¢nico, usa-se 'toilet' em vez de 'bathroom'." }
                ]
            }
        };
        
        // Estado atual da aplica√ß√£o
        let currentCollectionId = "numbers";
        let isEditing = false;
        let reviewMode = false;
        let incorrectCards = [];
        let reviewRound = 1;
        let totalCorrect = 0;
        let totalIncorrect = 0;
        
        // Elementos DOM
        const createCollectionBtn = document.getElementById('createCollectionBtn');
        const editCollectionBtn = document.getElementById('editCollectionBtn');
        const closeFormBtn = document.getElementById('closeFormBtn');
        const cancelFormBtn = document.getElementById('cancelFormBtn');
        const saveCollectionBtn = document.getElementById('saveCollectionBtn');
        const collectionForm = document.getElementById('collectionForm');
        const cardsContainer = document.getElementById('cardsContainer');
        const notification = document.getElementById('notification');
        const collectionSelect = document.getElementById('collectionSelect');
        const cardsCountElement = document.getElementById('cardsCount');
        const collectionNameInput = document.getElementById('collectionName');
        const collectionDescriptionInput = document.getElementById('collectionDescription');
        const flashcardsDataInput = document.getElementById('flashcardsData');
        const editingCollectionIdInput = document.getElementById('editingCollectionId');
        const formTitle = document.getElementById('formTitle');
        const completeBtn = document.getElementById('completeBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const correctCountElement = document.getElementById('correctCount');
        const incorrectCountElement = document.getElementById('incorrectCount');
        const reviewSection = document.getElementById('reviewSection');
        const completionMessage = document.getElementById('completionMessage');
        const startReviewBtn = document.getElementById('startReviewBtn');
        const restartCollectionBtn = document.getElementById('restartCollectionBtn');
        const reviewInfo = document.getElementById('reviewInfo');
        
        // Fun√ß√£o para mostrar notifica√ß√£o
        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Fun√ß√£o para criar elemento de flashcard
        function createFlashcardElement(card) {
            // Gerar URL de √°udio usando a API do Google Tradutor
            const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&tl=en&client=tw-ob&q=${encodeURIComponent(card.answer)}`;
            
            return `
                <div class="card" data-id="${card.id}">
                    <div class="card-header">
                        <span>Flashcard #${card.id}</span>
                        <div class="counter">
                            <div class="counter-item">
                                <span>Respondidas</span>
                                <span class="counter-value" id="answered-${card.id}">${card.answered}</span>
                            </div>
                            <div class="counter-item">
                                <span>Acertos</span>
                                <span class="counter-value" id="correct-${card.id}">${card.correct}</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="card-question">${card.question}</div>
                        
                        <div class="audio-player">
                            <div class="audio-btn" onclick="playAudio('${audioUrl}')">
                                <i class="fas fa-volume-up"></i>
                            </div>
                            <span>Ouvir pron√∫ncia</span>
                        </div>
                        
                        <button class="show-answer-btn" onclick="showAnswer('${currentCollectionId}', ${card.id})">
                            <i class="fas fa-eye"></i> Mostrar Resposta
                        </button>
                        
                        <div class="card-answer" id="answer-${card.id}">
                            <strong>Resposta:</strong> ${card.answer}
                        </div>
                        
                        <div class="explanation" id="explanation-${card.id}">
                            <strong>Explica√ß√£o:</strong> ${card.explanation}
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="progress-container">
                            <div class="progress-bar" id="progress-${card.id}" style="width: ${card.answered > 0 ? (card.correct / card.answered) * 100 : 0}%"></div>
                        </div>
                        <div>
                            <button class="feedback-btn correct" onclick="markCorrect('${currentCollectionId}', ${card.id})">
                                <i class="fas fa-check"></i> Acertei
                            </button>
                            <button class="feedback-btn incorrect" onclick="markIncorrect('${currentCollectionId}', ${card.id})">
                                <i class="fas fa-times"></i> Errei
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Fun√ß√£o para renderizar flashcards
        function renderFlashcards() {
            const collection = sampleFlashcards[currentCollectionId];
            let cards = collection.cards;
            
            if (reviewMode && incorrectCards.length > 0) {
                // Em modo de revis√£o, mostrar apenas os cards com erros
                cards = incorrectCards;
                reviewInfo.style.display = 'block';
            } else {
                reviewInfo.style.display = 'none';
            }
            
            // Atualiza contador de flashcards
            cardsCountElement.textContent = `${cards.length} flashcards`;
            
            if (cards.length === 0) {
                cardsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>Esta cole√ß√£o est√° vazia</h3>
                        <p>Voc√™ pode adicionar flashcards editando esta cole√ß√£o.</p>
                        <button class="btn btn-warning" onclick="editCurrentCollection()">
                            <i class="fas fa-edit"></i> Editar Cole√ß√£o
                        </button>
                    </div>
                `;
                return;
            }
            
            cardsContainer.innerHTML = cards.map(card => 
                createFlashcardElement(card)
            ).join('');
        }
        
        // Fun√ß√£o para mostrar resposta
        function showAnswer(collectionId, cardId) {
            const answerElement = document.getElementById(`answer-${cardId}`);
            const explanationElement = document.getElementById(`explanation-${cardId}`);
            
            answerElement.style.display = 'block';
            explanationElement.style.display = 'block';
            
            // Atualiza contador de respostas
            const card = sampleFlashcards[collectionId].cards.find(c => c.id === cardId);
            if (card && card.answered === 0) {
                card.answered++;
                document.getElementById(`answered-${cardId}`).textContent = card.answered;
                
                // Reproduz √°udio da resposta
                const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&tl=en&client=tw-ob&q=${encodeURIComponent(card.answer)}`;
                playAudio(audioUrl);
            }
        }
        
        // Fun√ß√£o para marcar como correto
        function markCorrect(collectionId, cardId) {
            const card = sampleFlashcards[collectionId].cards.find(c => c.id === cardId);
            if (card) {
                card.correct++;
                document.getElementById(`correct-${cardId}`).textContent = card.correct;
                
                // Atualiza barra de progresso
                const progress = card.answered > 0 ? (card.correct / card.answered) * 100 : 0;
                document.getElementById(`progress-${cardId}`).style.width = `${progress}%`;
                
                showNotification("Resposta marcada como correta! üëç", "success");
            }
        }
        
        // Fun√ß√£o para marcar como incorreto
        function markIncorrect(collectionId, cardId) {
            const card = sampleFlashcards[collectionId].cards.find(c => c.id === cardId);
            if (card) {
                showNotification("Continue praticando! üí™", "error");
                
                // Atualiza barra de progresso
                const progress = card.answered > 0 ? (card.correct / card.answered) * 100 : 0;
                document.getElementById(`progress-${cardId}`).style.width = `${progress}%`;
            }
        }
        
        // Fun√ß√£o para reproduzir √°udio
        function playAudio(url) {
            const audio = new Audio(url);
            audio.play().catch(e => console.log("Reprodu√ß√£o de √°udio bloqueada: ", e));
        }
        
        // Fun√ß√£o para mostrar formul√°rio de cria√ß√£o
        function showCreateForm() {
            isEditing = false;
            formTitle.innerHTML = `<i class="fas fa-folder-plus"></i> Criar Nova Cole√ß√£o`;
            collectionNameInput.value = '';
            collectionDescriptionInput.value = '';
            flashcardsDataInput.value = '';
            editingCollectionIdInput.value = '';
            collectionForm.style.display = 'block';
        }
        
        // Fun√ß√£o para mostrar formul√°rio de edi√ß√£o
        function editCurrentCollection() {
            isEditing = true;
            formTitle.innerHTML = `<i class="fas fa-edit"></i> Editar Cole√ß√£o`;
            
            const collection = sampleFlashcards[currentCollectionId];
            collectionNameInput.value = collection.name;
            collectionDescriptionInput.value = collection.description;
            
            // Converter flashcards para formato de texto
            const flashcardsText = collection.cards.map(card => 
                `${card.question} ; ${card.answer}`
            ).join('\n');
            
            flashcardsDataInput.value = flashcardsText;
            editingCollectionIdInput.value = currentCollectionId;
            
            collectionForm.style.display = 'block';
        }
        
        // Fun√ß√£o para esconder formul√°rio
        function hideForm() {
            collectionForm.style.display = 'none';
        }
        
        // Fun√ß√£o para salvar cole√ß√£o (cria√ß√£o ou edi√ß√£o)
        function saveCollection() {
            const name = collectionNameInput.value.trim();
            const description = collectionDescriptionInput.value.trim();
            const flashcardsData = flashcardsDataInput.value.trim();
            const collectionId = editingCollectionIdInput.value || name.toLowerCase().replace(/\s+/g, '-');
            
            if (!name) {
                showNotification("Por favor, insira um nome para a cole√ß√£o.", "error");
                return;
            }
            
            if (!flashcardsData) {
                showNotification("Por favor, insira pelo menos um flashcard.", "error");
                return;
            }
            
            // Parse dos flashcards
            const cards = [];
            const lines = flashcardsData.split('\n');
            let id = 1;
            
            for (const line of lines) {
                const parts = line.split(';');
                if (parts.length >= 2) {
                    cards.push({
                        id: id++,
                        question: parts[0].trim(),
                        answer: parts[1].trim(),
                        answered: 0,
                        correct: 0,
                        explanation: "Explica√ß√£o padr√£o - personalize conforme necess√°rio"
                    });
                }
            }
            
            if (cards.length === 0) {
                showNotification("Formato inv√°lido. Use: Pergunta ; Resposta", "error");
                return;
            }
            
            // Salvar cole√ß√£o
            sampleFlashcards[collectionId] = {
                name,
                description,
                cards
            };
            
            // Se for uma nova cole√ß√£o, adicionar ao seletor
            if (!isEditing) {
                const option = document.createElement('option');
                option.value = collectionId;
                option.textContent = name;
                collectionSelect.appendChild(option);
            }
            
            // Atualizar cole√ß√£o atual
            currentCollectionId = collectionId;
            collectionSelect.value = collectionId;
            renderFlashcards();
            
            // Feedback ao usu√°rio
            showNotification(
                `Cole√ß√£o "${name}" ${isEditing ? 'atualizada' : 'criada'} com ${cards.length} flashcards!`, 
                "success"
            );
            
            // Esconder formul√°rio
            hideForm();
        }
        
        // Fun√ß√£o para trocar cole√ß√£o
        function changeCollection() {
            currentCollectionId = collectionSelect.value;
            reviewMode = false;
            reviewRound = 1;
            renderFlashcards();
        }
        
        // Fun√ß√£o para exportar cole√ß√£o
        function exportCollection() {
            showNotification("Cole√ß√£o exportada com sucesso!", "success");
        }
        
        // Fun√ß√£o para imprimir cole√ß√£o
        function printCollection() {
            showNotification("Preparando para impress√£o...", "warning");
        }
        
        // Fun√ß√£o para concluir a revis√£o e mostrar resultados
        function completeReview() {
            const collection = sampleFlashcards[currentCollectionId];
            const cards = reviewMode ? incorrectCards : collection.cards;
            
            // Calcular totais da rodada atual
            let correctTotal = 0;
            let incorrectTotal = 0;
            let newIncorrectCards = [];
            
            cards.forEach(card => {
                if (card.answered > 0) {
                    if (card.correct > 0) {
                        correctTotal++;
                    } else {
                        incorrectTotal++;
                        // Adicionar card √† lista de errados para revis√£o
                        newIncorrectCards.push(card);
                    }
                }
            });
            
            // Atualizar totais gerais
            totalCorrect += correctTotal;
            totalIncorrect += incorrectTotal;
            
            // Atualizar elementos de resultados
            correctCountElement.textContent = correctTotal;
            incorrectCountElement.textContent = incorrectTotal;
            
            // Atualizar lista de cards incorretos para a pr√≥xima revis√£o
            incorrectCards = newIncorrectCards;
            
            // Mostrar se√ß√£o de revis√£o se houver erros
            if (incorrectTotal > 0) {
                reviewSection.style.display = 'block';
                completionMessage.style.display = 'none';
            } else {
                // Mostrar mensagem de conclus√£o se n√£o houver erros
                reviewSection.style.display = 'none';
                completionMessage.style.display = 'block';
            }
            
            // Ativar o modo de revis√£o para a pr√≥xima vez
            reviewMode = true;
            reviewRound++;
            
            // Mostrar resultados
            resultsContainer.style.display = 'block';
            
            // Atualizar t√≠tulo com o n√∫mero da rodada
            document.querySelector('.results-header').textContent = 
                `Resultados da Rodada ${reviewRound - 1}`;
            
            // Rolar at√© os resultados
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Fun√ß√£o para iniciar a revis√£o de erros
        function startReview() {
            // Reiniciar contadores dos cards errados para a nova tentativa
            incorrectCards.forEach(card => {
                card.answered = 0;
                card.correct = 0;
            });
            
            renderFlashcards();
            
            // Rolar de volta para os flashcards
            cardsContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Fun√ß√£o para reiniciar a cole√ß√£o
        function restartCollection() {
            const collection = sampleFlashcards[currentCollectionId];
            
            // Reiniciar todos os contadores
            collection.cards.forEach(card => {
                card.answered = 0;
                card.correct = 0;
            });
            
            reviewMode = false;
            reviewRound = 1;
            totalCorrect = 0;
            totalIncorrect = 0;
            incorrectCards = [];
            resultsContainer.style.display = 'none';
            renderFlashcards();
            
            // Rolar de volta para os flashcards
            cardsContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Event Listeners
        createCollectionBtn.addEventListener('click', showCreateForm);
        editCollectionBtn.addEventListener('click', editCurrentCollection);
        closeFormBtn.addEventListener('click', hideForm);
        cancelFormBtn.addEventListener('click', hideForm);
        saveCollectionBtn.addEventListener('click', saveCollection);
        collectionSelect.addEventListener('change', changeCollection);
        completeBtn.addEventListener('click', completeReview);
        startReviewBtn.addEventListener('click', startReview);
        restartCollectionBtn.addEventListener('click', restartCollection);
        
        // Inicializa√ß√£o
        renderFlashcards();
        
        // Expor fun√ß√µes para uso global
        window.showAnswer = showAnswer;
        window.markCorrect = markCorrect;
        window.markIncorrect = markIncorrect;
        window.playAudio = playAudio;
        window.editCurrentCollection = editCurrentCollection;
        window.exportCollection = exportCollection;
        window.printCollection = printCollection;
    </script>
</body>
</html>